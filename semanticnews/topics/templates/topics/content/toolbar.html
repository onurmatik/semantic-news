{% load i18n %}
{% if edit_mode %}
<div class="my-3" data-content-toolbar data-widget-toolbar>
    {% if widget_catalog %}
        <div class="mb-3" data-toolbar-panels>
            {% for widget in widget_catalog %}
                <template data-widget-panel="{{ widget.key }}">
                    {% include "topics/widgets/editor_card.html" with
                        widget_key=widget.key
                        widget_definition_id=widget.id
                        widget_id="widget-editor-"|add:widget.key
                        title=widget.name
                        validation_template="topics/widgets/validation_state.html"
                        validation_id="widgetValidation-"|add:widget.key
                        validation_variant="info"
                        content_template="topics/widgets/editors/shell_content.html"
                    %}
                </template>
            {% endfor %}
        </div>
    {% endif %}
    <div class="card border-light">
        <div class="card-body py-2">
            <div class="d-flex flex-wrap gap-2" data-toolbar-buttons>
                {% if widget_catalog %}
                    {% for widget in widget_catalog %}
                        <button
                            type="button"
                            class="btn btn-outline-secondary btn-sm"
                            data-toolbar-button="{{ widget.key }}"
                            data-widget-definition-id="{{ widget.id }}"
                            {% if topic.status == 'archived' %}disabled{% endif %}
                        >
                            {{ widget.name }}
                        </button>
                    {% endfor %}
                {% else %}
                    <p class="text-secondary small mb-0">{% trans "No widgets available." %}</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endif %}
