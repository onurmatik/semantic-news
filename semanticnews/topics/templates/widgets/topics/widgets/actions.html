{% load i18n %}
{% if actions %}
    {% with widget_name=widget.name|default_if_none:''|lower is_saved=section.id|default_if_none:'' %}
        {% with has_image=content.image_url|default_if_none:'' has_text=content.text|default:'' %}
            {% for action in actions %}
                {% with action_id=action.id action_name=action.name action_icon=action.icon action_key=action.name|default:''|lower %}
                    {% if widget_name == 'paragraph' %}
                        {% if action_key == 'generate' %}
                            {% with hidden_class=is_saved|yesno:'d-none,' %}
                                <button
                                    type="button"
                                    class="btn btn-outline-primary btn-sm {{ hidden_class }}"
                                    data-widget-action="{{ action_id }}"
                                    data-widget-action-id="{{ action_id }}"
                                    data-widget-visibility="draft"
                                    {% if action_name %}data-widget-action-name="{{ action_name }}"{% endif %}
                                    {% if action_name %}title="{{ action_name }}" aria-label="{{ action_name }}"{% else %}aria-label="{% trans "Widget action" %}"{% endif %}
                                >
                                    <i class="{{ action_icon|default:'bi bi-stars' }}" aria-hidden="true"></i>
                                    {% if action_name %}
                                        <span class="visually-hidden">{{ action_name }}</span>
                                    {% endif %}
                                </button>
                            {% endwith %}
                        {% else %}
                            <button
                                type="button"
                                class="btn btn-outline-primary btn-sm {% if not is_saved or not has_text %}d-none{% endif %}"
                                data-widget-action="{{ action_id }}"
                                data-widget-action-id="{{ action_id }}"
                                data-widget-visibility="saved-with-text"
                                {% if action_name %}data-widget-action-name="{{ action_name }}"{% endif %}
                                {% if action_name %}title="{{ action_name }}" aria-label="{{ action_name }}"{% else %}aria-label="{% trans "Widget action" %}"{% endif %}
                            >
                                <i class="{{ action_icon|default:'bi bi-stars' }}" aria-hidden="true"></i>
                                {% if action_name %}
                                    <span class="visually-hidden">{{ action_name }}</span>
                                {% endif %}
                            </button>
                        {% endif %}
                    {% elif widget_name == 'image' %}
                        {% if action_key == 'generate' %}
                            {% with hidden_class=has_image|yesno:'d-none,' %}
                                <button
                                    type="button"
                                    class="btn btn-outline-primary btn-sm {{ hidden_class }}"
                                    data-widget-action="{{ action_id }}"
                                    data-widget-action-id="{{ action_id }}"
                                    data-widget-visibility="needs-image"
                                    {% if action_name %}data-widget-action-name="{{ action_name }}"{% endif %}
                                    {% if action_name %}title="{{ action_name }}" aria-label="{{ action_name }}"{% else %}aria-label="{% trans "Widget action" %}"{% endif %}
                                >
                                    <i class="{{ action_icon|default:'bi bi-stars' }}" aria-hidden="true"></i>
                                    {% if action_name %}
                                        <span class="visually-hidden">{{ action_name }}</span>
                                    {% endif %}
                                </button>
                            {% endwith %}
                        {% elif action_key == 'variate' %}
                            {% with hidden_class=has_image|yesno:',d-none' %}
                                <button
                                    type="button"
                                    class="btn btn-outline-primary btn-sm {{ hidden_class }}"
                                    data-widget-action="{{ action_id }}"
                                    data-widget-action-id="{{ action_id }}"
                                    data-widget-visibility="saved-with-image"
                                    {% if action_name %}data-widget-action-name="{{ action_name }}"{% endif %}
                                    {% if action_name %}title="{{ action_name }}" aria-label="{{ action_name }}"{% else %}aria-label="{% trans "Widget action" %}"{% endif %}
                                >
                                    <i class="{{ action_icon|default:'bi bi-stars' }}" aria-hidden="true"></i>
                                    {% if action_name %}
                                        <span class="visually-hidden">{{ action_name }}</span>
                                    {% endif %}
                                </button>
                            {% endwith %}
                        {% endif %}
                    {% else %}
                        <button
                            type="button"
                            class="btn btn-outline-primary btn-sm"
                            data-widget-action="{{ action_id }}"
                            data-widget-action-id="{{ action_id }}"
                            {% if action_name %}data-widget-action-name="{{ action_name }}"{% endif %}
                            {% if action_name %}title="{{ action_name }}" aria-label="{{ action_name }}"{% else %}aria-label="{% trans "Widget action" %}"{% endif %}
                        >
                            <i class="{{ action_icon|default:'bi bi-stars' }}" aria-hidden="true"></i>
                            {% if action_name %}
                                <span class="visually-hidden">{{ action_name }}</span>
                            {% endif %}
                        </button>
                    {% endif %}
                {% endwith %}
            {% endfor %}
        {% endwith %}
    {% endwith %}
    {% if widget.name == "paragraph" or widget.name == "image" %}
        {% if widget.name == "image" %}
            {% trans "image" as delete_target %}
        {% else %}
            {% trans "paragraph" as delete_target %}
        {% endif %}
        {% blocktrans asvar delete_label with target=delete_target %}Delete {{ target }}{% endblocktrans %}
        {% blocktrans asvar move_up_label with target=delete_target %}Move {{ target }} up{% endblocktrans %}
        {% blocktrans asvar move_down_label with target=delete_target %}Move {{ target }} down{% endblocktrans %}
        <div class="btn-group {% if not section.id %}d-none{% endif %}" role="group" aria-label="{% trans "Section ordering controls" %}">
            <button
                type="button"
                class="btn btn-outline-secondary btn-sm"
                data-widget-move="up"
                data-widget-section-id="{{ section.id|default_if_none:'' }}"
                title="{{ move_up_label }}"
                aria-label="{{ move_up_label }}"
                {% if not section.id %}disabled{% endif %}
            >
                <i class="bi bi-arrow-up" aria-hidden="true"></i>
                <span class="visually-hidden">{{ move_up_label }}</span>
            </button>
            <button
                type="button"
                class="btn btn-outline-secondary btn-sm"
                data-widget-move="down"
                data-widget-section-id="{{ section.id|default_if_none:'' }}"
                title="{{ move_down_label }}"
                aria-label="{{ move_down_label }}"
                {% if not section.id %}disabled{% endif %}
            >
                <i class="bi bi-arrow-down" aria-hidden="true"></i>
                <span class="visually-hidden">{{ move_down_label }}</span>
            </button>
            <button
                type="button"
                class="btn btn-outline-danger btn-sm"
                data-widget-delete-section-id="{{ section.id|default_if_none:'' }}"
                data-widget-delete-label="{{ delete_target }}"
                data-widget-visibility="saved"
                title="{{ delete_label }}"
                aria-label="{{ delete_label }}"
            >
                <i class="bi bi-trash" aria-hidden="true"></i>
                <span class="visually-hidden">{{ delete_label }}</span>
            </button>
        </div>
    {% endif %}
{% endif %}
