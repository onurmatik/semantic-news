
{% load i18n %}

<div class="event-item mb-3" data-event-uuid="{{ event.uuid }}" data-categories="{% for category in event.categories.all %}{% if not forloop.first %} {% endif %}{{ category.name|slugify }}{% endfor %}">
    <p class="text-secondary small mb-0">
        {{ event.date|date:"M d, Y" }}
        {% for category in event.categories.all %}
            &middot; {{ category }}
        {% endfor %}
    </p>
    <h2 class="fs-6">
        <a href="{{ event.get_absolute_url }}">{{ event.title }}</a>
    </h2>
    <p>
        {% for source in event.sources.all %}
            <a class="small text-secondary" target="_blank" href="{{ source }}">{{ source.get_domain }}</a>
            {% if not forloop.last %}&middot;{% endif %}
        {%  endfor %}
    </p>
    {% if request.user.is_authenticated and show_add|default:True %}
        <div class="dropdown d-inline">
            <button class="btn btn-sm btn-outline-primary dropdown-toggle"
                    type="button" data-bs-toggle="dropdown" aria-expanded="false"
                    {% if archived %}disabled{% endif %}>
                {% trans "Add" %}
            </button>
            <ul class="dropdown-menu">
                {% if topic %}
                <li><a class="dropdown-item small add-to-topic" href="#" data-topic-uuid="{{ topic.uuid }}" data-event-uuid="{{ event.uuid }}">{% trans "This topic" %}</a></li>
                <li><hr class="dropdown-divider"></li>
                {% endif %}
                <li><h6 class="dropdown-header">{% trans "Your topics" %}</h6></li>
                {% for t in user_topics %}
                <li><a class="dropdown-item small add-to-topic" href="#" data-topic-uuid="{{ t.uuid }}" data-event-uuid="{{ event.uuid }}">{{ t.title }}</a></li>
                {% empty %}
                    <li><em class="small">You haven't created any topics yet.</em></li>
                {% endfor %}
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item small add-topic-btn" href="#" data-event-title="{{ event.title }}">{% trans "Create new topic" %}</a></li>
            </ul>
        </div>
    {% endif %}
    {% if show_remove and request.user.is_authenticated %}
        <button type="button"
                class="btn btn-sm btn-outline-danger remove-event-btn"
                data-add-label="{% trans 'Add' %}"
                data-remove-label="{% trans 'Remove' %}"
                {% if archived %}disabled{% endif %}>
            {% trans "Remove" %}
        </button>
    {% endif %}
</div>

